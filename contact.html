<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contacto · Mi sitio</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
</head>

<body>

  <header class="bg-white border-bottom sticky-top">
    <div class="container py-3 d-flex justify-content-between align-items-center">
      <h1 class="h4 m-0">Logitech G</h1>

      <nav class="d-flex gap-3">
        <a href="index.html">Inicio</a>
        <a href="about.html">Descubrir</a>
        <a href="contact.html" class="active">Comprar</a>
        <a href="store.html">Tienda</a>
      </nav>
    </div>
  </header>

  <main class="container py-5">
    <section class="bg-white p-4 rounded-4 shadow-sm">
      <h2 class="h5 mb-3">Contacto</h2>
      <p class="text-muted mb-4">Este formulario guarda mensajes en Realtime Database.</p>

      <form id="contactForm" class="row g-3">
        <div class="col-12 col-md-6">
          <label class="form-label">Nombre</label>
          <input class="form-control" type="text" name="nombre" required>
        </div>

        <div class="col-12 col-md-6">
          <label class="form-label">Email</label>
          <input class="form-control" type="email" name="email" required>
        </div>

        <div class="col-12">
          <label class="form-label">Mensaje</label>
          <textarea class="form-control" name="mensaje" rows="4" required></textarea>
        </div>

        <div class="col-12 col-md-6">
          <label class="form-label">Producto deseado</label>
          <select class="form-select" name="producto" required>
            <option value="-Categoría-">- Seleccionar categoria -</option>
            <option value="Mouses">Mouses</option>
            <option value="Teclados">Teclados</option>
            <option value="Mousepads">Mousepads</option>
            <option value="Audio/audífonos">Audio/audífonos</option>
            <option value="Micrófonos">Micrófonos</option>
          </select>
        </div>

        <div class="col-12 d-flex gap-2">
          <button id="submitBtn" class="btn btn-success" type="submit">Enviar mensaje</button>
          <button class="btn btn-outline-secondary" type="reset">Limpiar</button>
        </div>
      </form>

      <div id="status" class="mt-3"></div>
    </section>
  </main>

  <footer class="bg-white border-top">
    <div class="container py-3 text-center text-muted">
      <small>© 2026 · Mi sitio</small>
    </div>
  </footer>

  <!-- Firebase + Realtime Database -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import { getDatabase, ref, push, set, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

    // Tu configuración (Realtime Database usa databaseURL)
    const firebaseConfig = {
    apiKey: "AIzaSyCQQYMUgoUx-efjOGC1yvTZExFsbtMI57s",
    authDomain: "logitechtechg.firebaseapp.com",
    projectId: "logitechtechg",
    storageBucket: "logitechtechg.firebasestorage.app",
    messagingSenderId: "416244789524",
    appId: "1:416244789524:web:0fffd9cee2379a7ee85201"
  };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const form = document.getElementById("contactForm");
    const statusDiv = document.getElementById("status");
    const submitBtn = document.getElementById("submitBtn");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        nombre: form.nombre.value.trim(),
        email: form.email.value.trim(),
        mensaje: form.mensaje.value.trim(),
        createdAt: serverTimestamp(),
        page: location.href
      };

      if (!data.nombre || !data.email || !data.mensaje) {
        statusDiv.innerHTML = `<div class="alert alert-warning">Completa todos los campos.</div>`;
        return;
      }

      statusDiv.innerHTML = `<div class="alert alert-info">Enviando...</div>`;
      submitBtn.disabled = true;

      try {
        // Crea un nuevo registro en /contactos con un id único
        const newRef = push(ref(db, "contactos"));
        await set(newRef, data);

        statusDiv.innerHTML = `<div class="alert alert-success">✅ Mensaje enviado.</div>`;
        form.reset();
      } catch (err) {
        console.error(err);
        statusDiv.innerHTML = `
          <div class="alert alert-danger">
            ❌ Error: <strong>${err?.code || "sin código"}</strong><br>
            ${err?.message || "sin mensaje"}
          </div>`;
      } finally {
        submitBtn.disabled = false;
      }
    });
  </script>

</body>
</html>
